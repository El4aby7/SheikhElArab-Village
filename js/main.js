// Translations Dictionary
const translations = {
    "en": {
        "brand_name": "Abu Khaled Village",
        "nav_menu": "Menu",
        "nav_story": "Our Story",
        "nav_private_tents": "Private Tents",
        "nav_contact": "Contact",
        "nav_home": "Home",
        "nav_reservations": "Reservations",
        "nav_locations": "Locations",
        "btn_order": "Order Online",
        "hero_badge": "Authentic Middle Eastern Flavors",
        "hero_title_1": "The Art of",
        "hero_title_2": "Fire & Spice",
        "hero_desc": "Experience the taste of the desert in the heart of the city. Slow-cooked Mandi, smoky Egyptian BBQ, and authentic Bedouin hospitality.",
        "btn_book_tent": "Book a Private Tent",
        "btn_view_menu": "View Full Menu",
        "section_specialties": "Our Specialties",
        "section_charcoal": "From the Charcoal Pit",
        "dish_mandi": "Signature Mandi",
        "dish_mandi_desc": "Slow-cooked lamb shank served over aromatic saffron rice with raisin and nuts.",
        "dish_kofta": "Egyptian Kofta",
        "dish_kofta_desc": "Spiced minced meat skewers grilled to perfection over open charcoal flame.",
        "dish_madhbi": "Chicken Madhbi",
        "dish_madhbi_desc": "Whole chicken grilled on hot stones, served with spicy tomato salsa (Sahaweq).",
        "dish_bread": "Bedouin Bread Basket",
        "dish_bread_desc": "Selection of fresh, wood-fired flatbreads served with hummus and baba ganoush.",
        "exp_badge": "Atmosphere",
        "exp_title": "The Bedouin Tent Experience",
        "exp_desc": "Escape the noise and relax in our authentic private tents. Adorned with traditional kilim carpets, warm lantern lighting, and low Majlis seating, our tents are designed for communal feasting and intimate gatherings.",
        "exp_feat_1": "Private seating for groups of 4-12",
        "exp_feat_2": "Traditional Arabic tea service",
        "exp_feat_3": "Ambient desert soundscapes",
        "btn_explore": "Explore Ambience",
        "rating_label": "Customer Rating",
        "find_us": "Find us in the Dunes",
        "address_1": "123 Desert Road, Al Quoz Industrial Area 4",
        "address_2": "Dubai, United Arab Emirates",
        "hours_label": "Daily:",
        "btn_directions": "Get Directions",
        "footer_desc": "Bringing authentic desert flavors to the modern city. Experience the warmth of Bedouin hospitality.",
        "footer_links": "Quick Links",
        "footer_catering": "Catering",
        "footer_gifts": "Gift Cards",
        "footer_connect": "Connect",
        "footer_newsletter": "Newsletter",
        "footer_newsletter_desc": "Subscribe for seasonal updates and exclusive offers.",
        "footer_privacy": "Privacy Policy",
        "footer_terms": "Terms of Service",
        "hero_subtitle": "Authentic Bedouin Cuisine",
        "dish_highlight_title": "Lamb Haneeth",
        "dish_highlight_desc": "Slow-cooked for 12 hours in a traditional underground clay oven.",
        "btn_book_table": "Book a Table",
        "menu_title": "Our Menu",
        "menu_desc": "A journey through the desert's most cherished recipes, featuring premium meats and ancient spice blends.",
        "section_mandi": "The Mandi Pit",
        "dish_haneeth": "Lamb Haneeth",
        "dish_haneeth_desc": "Succulent lamb shoulder slow-roasted in foil to preserve juices, served over aromatic basmati rice.",
        "dish_zurbian": "Shoulder Zurbian",
        "dish_zurbian_desc": "A royal dish of tender meat cooked within a spiced yogurt sauce and potato infused rice.",
        "section_bbq": "Egyptian BBQ",
        "dish_tarb": "Tarb",
        "dish_tarb_desc": "Kofta wrapped in a thin layer of lamb fat (caul fat) for an incredibly juicy and rich experience.",
        "dish_shish": "Shish Tawook",
        "dish_shish_desc": "Chicken breast cubes marinated in yogurt, lemon, and garlic, grilled to perfection with peppers.",
        "section_souk": "From the Souk",
        "side_hummus": "Hummus with Meat",
        "side_hummus_desc": "Creamy chickpea puree topped with sautéed minced lamb and pine nuts.",
        "side_baba": "Baba Ganoush",
        "side_baba_desc": "Roasted eggplant dip mixed with tahini, olive oil, and pomegranate molasses.",
        "side_salad": "Bedouin Salad",
        "side_salad_desc": "Fresh diced cucumbers, tomatoes, and parsley with a zesty lemon dressing.",
        "side_bread": "Fresh Mulawah",
        "side_bread_desc": "Giant, flaky Yemeni bread baked fresh in the clay oven.",
        "footer_halal": "All our meats are Halal and sourced from local farms. Please inform your server of any allergies.",
        "btn_download_pdf": "Download PDF Menu",
        "btn_book_now": "Book Now",
        "res_title": "Choose Your Experience",
        "res_desc": "Select your preferred dining style to begin your journey. From the traditional warmth of the Majlis to our classic elegant tables.",
        "res_opt_1_label": "Traditional Choice",
        "res_opt_1_title": "Traditional Floor Seating (Majlis)",
        "res_opt_1_desc": "Immerse yourself in tradition. Features low seating, plush cushions, and shared platters meant for communal dining. Shoes removed for comfort.",
        "res_opt_2_label": "Modern Comfort",
        "res_opt_2_title": "Standard Dining",
        "res_opt_2_desc": "Classic comfort with a touch of Bedouin flair. Chair and table arrangement perfect for formal dining or those who prefer upright seating.",
        "res_details_title": "Reservation Details",
        "res_step": "Step 2 of 3",
        "res_date_label": "Select Date",
        "res_time_label": "Select Time",
        "res_guests_label": "Guests",
        "res_large_groups": "For groups larger than 10, please contact us directly.",
        "res_total_est": "Total Estimate (Pre-payment not required)",
        "res_free": "Free Reservation",
        "btn_confirm_majlis": "Confirm Majlis Seating",
        "btn_confirm_standard": "Confirm Standard Dining",
        "trust_instant": "Instant Confirmation",
        "trust_cancel": "No Cancellation Fee",
        "trust_rating": "4.9/5 Guest Rating"
    },
    "ar": {
        "brand_name": "قرية أبو خالد",
        "nav_menu": "القائمة",
        "nav_story": "قصتنا",
        "nav_private_tents": "الخيام الخاصة",
        "nav_contact": "اتصل بنا",
        "nav_home": "الرئيسية",
        "nav_reservations": "الحجوزات",
        "nav_locations": "الفروع",
        "btn_order": "اطلب أونلاين",
        "hero_badge": "نكهات شرق أوسطية أصيلة",
        "hero_title_1": "فن",
        "hero_title_2": "النار والتوابل",
        "hero_desc": "اختبر طعم الصحراء في قلب المدينة. مندي مطهو ببطء، مشاوي مصرية، وضيافة بدوية أصيلة.",
        "btn_book_tent": "احجز خيمة خاصة",
        "btn_view_menu": "عرض القائمة الكاملة",
        "section_specialties": "تخصصاتنا",
        "section_charcoal": "من مشواة الفحم",
        "dish_mandi": "مندي مميز",
        "dish_mandi_desc": "موزة ضأن مطهوة ببطء تقدم مع أرز بالزعفران والمكسرات.",
        "dish_kofta": "كفتة مصرية",
        "dish_kofta_desc": "أسياخ لحم مفروم متبل مشوي على الفحم.",
        "dish_madhbi": "دجاج مظبي",
        "dish_madhbi_desc": "دجاج كامل مشوي على الحجارة الساخنة، يقدم مع صلصة الطماطم الحارة.",
        "dish_bread": "سلة خبز بدوي",
        "dish_bread_desc": "تشكيلة من الخبز الطازج المخبوز على الحطب يقدم مع الحمص والبابا غنوج.",
        "exp_badge": "الأجواء",
        "exp_title": "تجربة الخيمة البدوية",
        "exp_desc": "اهرب من الضجيج واسترخ في خيامنا الخاصة الأصيلة. مزينة بالسجاد التقليدي والإضاءة الدافئة والجلسات الأرضية.",
        "exp_feat_1": "جلسات خاصة لمجموعات من 4-12",
        "exp_feat_2": "خدمة الشاي العربي التقليدي",
        "exp_feat_3": "أجواء صحراوية هادئة",
        "btn_explore": "اكتشف الأجواء",
        "rating_label": "تقييم العملاء",
        "find_us": "تجدنا في الكثبان",
        "address_1": "123 طريق الصحراء، منطقة القوز الصناعية 4",
        "address_2": "دبي، الإمارات العربية المتحدة",
        "hours_label": "يومياً:",
        "btn_directions": "احصل على الاتجاهات",
        "footer_desc": "نحضر نكهات الصحراء الأصيلة إلى المدينة الحديثة. استمتع بضيافة البدو.",
        "footer_links": "روابط سريعة",
        "footer_catering": "التموين",
        "footer_gifts": "بطاقات الهدايا",
        "footer_connect": "تواصل معنا",
        "footer_newsletter": "النشرة البريدية",
        "footer_newsletter_desc": "اشترك للحصول على تحديثات وعروض حصرية.",
        "footer_privacy": "سياسة الخصوصية",
        "footer_terms": "شروط الخدمة",
        "hero_subtitle": "مأكولات بدوية أصيلة",
        "dish_highlight_title": "حنيذ لحم",
        "dish_highlight_desc": "مطهو ببطء لمدة 12 ساعة في فرن فخاري تحت الأرض.",
        "btn_book_table": "احجز طاولة",
        "menu_title": "قائمتنا",
        "menu_desc": "رحلة عبر وصفات الصحراء المحبوبة، مع أجود اللحوم والتوابل القديمة.",
        "section_mandi": "حفرة المندي",
        "dish_haneeth": "حنيذ لحم",
        "dish_haneeth_desc": "كتف ضأن طري مشوي ببطء في القصدير للحفاظ على العصارة، يقدم مع أرز البسمتي.",
        "dish_zurbian": "زربيان كتف",
        "dish_zurbian_desc": "طبق ملكي من اللحم الطري المطهو في صلصة الزبادي المتبلة وأرز البطاطس.",
        "section_bbq": "مشاوي مصرية",
        "dish_tarb": "طرب",
        "dish_tarb_desc": "كفتة ملفوفة بطبقة رقيقة من دهن الضأن لتجربة غنية.",
        "dish_shish": "شيش طاووق",
        "dish_shish_desc": "مكعبات صدور دجاج متبلة بالزبادي والليمون والثوم، مشوية مع الفلفل.",
        "section_souk": "من السوق",
        "side_hummus": "حمص باللحم",
        "side_hummus_desc": "مهروس الحمص الكريمي مغطى باللحم المفروم المقلي والصنوبر.",
        "side_baba": "بابا غنوج",
        "side_baba_desc": "باذنجان مشوي مخلوط بالطحينة وزيت الزيتون ودبس الرمان.",
        "side_salad": "سلطة بدوية",
        "side_salad_desc": "خيار وطماطم وبقدونس طازج مقطع مع تتبيلة الليمون.",
        "side_bread": "ملوح طازج",
        "side_bread_desc": "خبز يمني عملاق وهش يخبز طازجاً في فرن الفخار.",
        "footer_halal": "جميع لحومنا حلال ومصدرها مزارع محلية. يرجى إبلاغ النادل بأي حساسية.",
        "btn_download_pdf": "تحميل القائمة PDF",
        "btn_book_now": "احجز الآن",
        "res_title": "اختر تجربتك",
        "res_desc": "اختر نمط تناول الطعام المفضل لديك لبدء رحلتك. من دفء المجلس التقليدي إلى طاولاتنا الأنيقة.",
        "res_opt_1_label": "خيار تقليدي",
        "res_opt_1_title": "جلسة أرضية تقليدية (مجلس)",
        "res_opt_1_desc": "انغمس في التقاليد. جلسات منخفضة ووسائد مريحة وولائم مشتركة. تخلع الأحذية للراحة.",
        "res_opt_2_label": "راحة عصرية",
        "res_opt_2_title": "طعام قياسي",
        "res_opt_2_desc": "راحة كلاسيكية مع لمسة بدوية. ترتيب طاولات وكراسي مثالي للطعام الرسمي.",
        "res_details_title": "تفاصيل الحجز",
        "res_step": "خطوة 2 من 3",
        "res_date_label": "اختر التاريخ",
        "res_time_label": "اختر الوقت",
        "res_guests_label": "الضيوف",
        "res_large_groups": "للمجموعات الأكبر من 10، يرجى التواصل معنا مباشرة.",
        "res_total_est": "التقدير الإجمالي (الدفع المسبق غير مطلوب)",
        "res_free": "حجز مجاني",
        "btn_confirm_majlis": "تأكيد حجز المجلس",
        "btn_confirm_standard": "تأكيد حجز الطاولة",
        "trust_instant": "تأكيد فوري",
        "trust_cancel": "بدون رسوم إلغاء",
        "trust_rating": "4.9/5 تقييم الضيوف"
    }
};

document.addEventListener('DOMContentLoaded', () => {
    // Theme Toggle Logic
    const themeToggleBtn = document.getElementById('theme-toggle');
    const htmlElement = document.documentElement;

    // Check for saved user preference, if any, on load of the website
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        htmlElement.classList.add('dark');
        updateThemeIcon(true);
    } else {
        htmlElement.classList.remove('dark');
        updateThemeIcon(false);
    }

    themeToggleBtn.addEventListener('click', () => {
        if (htmlElement.classList.contains('dark')) {
            htmlElement.classList.remove('dark');
            localStorage.theme = 'light';
            updateThemeIcon(false);
        } else {
            htmlElement.classList.add('dark');
            localStorage.theme = 'dark';
            updateThemeIcon(true);
        }
    });

    function updateThemeIcon(isDark) {
        const iconSpan = themeToggleBtn.querySelector('.material-symbols-outlined');
        if (iconSpan) {
            iconSpan.textContent = isDark ? 'light_mode' : 'dark_mode';
        }
    }

    // Language Toggle Logic
    const langToggleBtn = document.getElementById('lang-toggle');
    let currentLang = localStorage.getItem('lang') || 'en';

    // Initialize Language
    setLanguage(currentLang);

    langToggleBtn.addEventListener('click', () => {
        currentLang = currentLang === 'en' ? 'ar' : 'en';
        setLanguage(currentLang);
    });

    function setLanguage(lang) {
        localStorage.setItem('lang', lang);

        // Update HTML attributes
        htmlElement.setAttribute('lang', lang);
        htmlElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');

        // Update Toggle Button Text
        langToggleBtn.textContent = lang === 'en' ? 'AR' : 'EN';

        // Update Text Content
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[lang] && translations[lang][key]) {
                // Preserve nested structure if any, though innerText usually wipes it.
                // For this simple implementation, innerText is fine for most text.
                // However, for elements with nested spans (like the hero title), we need to be careful.
                // In my HTML, I attached data-i18n to the leaf nodes usually, or spans.
                element.innerText = translations[lang][key];
            }
        });

        // Flip arrow buttons in RTL
        const scrollBtns = document.querySelectorAll('#scroll-left, #scroll-right');
        scrollBtns.forEach(btn => {
            if (lang === 'ar') {
                btn.style.transform = 'scaleX(-1)';
            } else {
                btn.style.transform = 'none';
            }
        });
    }

    // Horizontal Scroll Logic for Specialties
    const scrollContainer = document.getElementById('specialties-container');
    const scrollLeftBtn = document.getElementById('scroll-left');
    const scrollRightBtn = document.getElementById('scroll-right');

    if (scrollContainer && scrollLeftBtn && scrollRightBtn) {
        scrollLeftBtn.addEventListener('click', () => {
            const isRTL = document.documentElement.getAttribute('dir') === 'rtl';
            const amount = isRTL ? 300 : -300;
            scrollContainer.scrollBy({ left: amount, behavior: 'smooth' });
        });
        scrollRightBtn.addEventListener('click', () => {
            const isRTL = document.documentElement.getAttribute('dir') === 'rtl';
            const amount = isRTL ? -300 : 300;
            scrollContainer.scrollBy({ left: amount, behavior: 'smooth' });
        });
    }

    // Reservations Logic
    const expMajlis = document.getElementById('exp-majlis');
    const expStandard = document.getElementById('exp-standard');

    if (expMajlis && expStandard) {
        // Experience Toggle
        let activeExp = 'majlis';
        const confirmText = document.getElementById('confirm-text');

        function setExperience(type) {
            activeExp = type;
            if (type === 'majlis') {
                expMajlis.classList.add('border-primary');
                expMajlis.classList.remove('border-transparent');
                expMajlis.querySelector('.absolute').classList.remove('hidden');

                expStandard.classList.remove('border-primary');
                expStandard.classList.add('border-transparent');
                expStandard.querySelector('.absolute').classList.add('hidden');

                // Update button text key
                confirmText.setAttribute('data-i18n', 'btn_confirm_majlis');
                const lang = localStorage.getItem('lang') || 'en';
                confirmText.innerText = translations[lang]['btn_confirm_majlis'];
            } else {
                expStandard.classList.add('border-primary');
                expStandard.classList.remove('border-transparent');
                expStandard.querySelector('.absolute').classList.remove('hidden');

                expMajlis.classList.remove('border-primary');
                expMajlis.classList.add('border-transparent');
                expMajlis.querySelector('.absolute').classList.add('hidden');

                // Update button text key
                confirmText.setAttribute('data-i18n', 'btn_confirm_standard');
                const lang = localStorage.getItem('lang') || 'en';
                confirmText.innerText = translations[lang]['btn_confirm_standard'];
            }
        }

        expMajlis.addEventListener('click', () => setExperience('majlis'));
        expStandard.addEventListener('click', () => setExperience('standard'));

        // Date Selection
        const dateContainer = document.getElementById('date-container');
        if (dateContainer) {
            const dateBtns = dateContainer.querySelectorAll('.date-btn');
            dateBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    dateBtns.forEach(b => {
                        b.classList.remove('bg-primary', 'text-[#181611]', 'border-primary', 'active');
                        b.classList.add('bg-[#393528]', 'text-[#bab29c]', 'border-transparent');
                    });
                    btn.classList.remove('bg-[#393528]', 'text-[#bab29c]', 'border-transparent');
                    btn.classList.add('bg-primary', 'text-[#181611]', 'border-primary', 'active');
                });
            });
        }

        // Time Selection
        const timeContainer = document.getElementById('time-container');
        if (timeContainer) {
            const timeBtns = timeContainer.querySelectorAll('.time-btn');
            timeBtns.forEach(btn => {
                if (!btn.disabled) {
                    btn.addEventListener('click', () => {
                        timeBtns.forEach(b => {
                            if (!b.disabled) {
                                b.classList.remove('bg-primary/20', 'border-primary', 'text-primary', 'active');
                                b.classList.add('border-[#393528]', 'text-[#bab29c]');
                            }
                        });
                        btn.classList.remove('border-[#393528]', 'text-[#bab29c]');
                        btn.classList.add('bg-primary/20', 'border-primary', 'text-primary', 'active');
                    });
                }
            });
        }

        // Guest Count Logic
        const guestCountEl = document.getElementById('guest-count');
        const decreaseBtn = document.getElementById('guest-decrease');
        const increaseBtn = document.getElementById('guest-increase');

        if (guestCountEl && decreaseBtn && increaseBtn) {
            let guests = 4;

            decreaseBtn.addEventListener('click', () => {
                if (guests > 1) {
                    guests--;
                    guestCountEl.textContent = guests;
                }
            });

            increaseBtn.addEventListener('click', () => {
                if (guests < 20) {
                    guests++;
                    guestCountEl.textContent = guests;
                }
            });
        }

        // Confirmation
        const confirmBtn = document.getElementById('confirm-reservation');
        if (confirmBtn) {
            confirmBtn.addEventListener('click', () => {
                const lang = localStorage.getItem('lang') || 'en';
                const msg = lang === 'ar' ? 'تم استلام طلب الحجز الخاص بك!' : 'Reservation request received!';
                alert(msg);
            });
        }
    }
});
